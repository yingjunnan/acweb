# 终端功能说明

## 新增功能

### 1. 自定义会话名称
- 点击"新建会话"按钮会弹出对话框
- 可以输入自定义的会话名称（例如：开发环境、生产环境、测试服务器等）
- **会话名称不能重复**，输入时会实时验证
- 默认名称为"终端 N"（N 为序号）
- 支持按 Enter 键快速创建
- 页面首次打开时自动创建"默认终端"

### 2. 智能提示
- **创建终端**：显示 "终端 '名称' 创建成功"
- **连接成功**：显示 "名称 连接成功"
- **关闭终端**：显示 "终端 '名称' 已关闭"
- **连接错误**：显示 "名称 连接错误"
- **名称重复**：实时显示错误提示，禁用创建按钮

### 3. 会话持久化
- 终端会话在切换菜单时不会关闭
- 会话状态保存在全局 Store 中
- 可以在仪表盘、配置页面之间自由切换
- 返回终端页面时，所有会话都会保持原状

### 4. 会话管理
- 支持多个终端会话同时运行
- 每个会话独立连接到服务器
- 可以通过标签页切换不同会话
- 点击标签页的 X 按钮关闭会话
- 至少保留一个会话（最后一个会话不能关闭）

### 5. 退出登录时清理
- 退出登录时会自动关闭所有终端会话
- 清理所有 WebSocket 连接
- 释放所有终端资源
- 确保不会有残留连接

## 使用场景

### 场景 1：多环境管理
```
终端 1: 开发环境 (~/projects/dev)
终端 2: 生产环境 (~/projects/prod)
终端 3: 日志监控 (tail -f logs)
```

### 场景 2：多任务并行
```
终端 1: 前端开发 (npm run dev)
终端 2: 后端开发 (python manage.py runserver)
终端 3: 数据库操作 (mysql -u root -p)
```

### 场景 3：临时查看
- 在终端中运行长时间任务
- 切换到仪表盘查看系统状态
- 切换到配置页面调整设置
- 返回终端查看任务进度

## 技术实现

### 全局状态管理
使用 Pinia Store 管理终端状态：
- `sessions`: 所有会话列表
- `activeSession`: 当前激活的会话
- `terminals`: 终端实例映射
- `websockets`: WebSocket 连接映射
- `terminalRefs`: DOM 引用映射

### 生命周期管理
- `onMounted`: 恢复已有会话或创建新会话
- `onUnmounted`: 不关闭会话（保持连接）
- `handleLogout`: 清理所有会话和连接

### 响应式更新
- 使用 `watch` 监听会话切换
- 自动调整终端尺寸适配容器
- 支持窗口大小变化时自动调整

## 注意事项

1. **会话命名**：建议使用有意义的名称，方便识别
2. **资源占用**：每个会话都会占用服务器资源，不用的会话应及时关闭
3. **连接状态**：切换菜单时会话保持连接，但长时间不活动可能被服务器断开
4. **退出登录**：退出登录会关闭所有会话，未保存的工作会丢失
